<api context="/api" name="dataTransformationAPI" xmlns="http://ws.apache.org/ns/synapse">
    <resource methods="POST" uri-template="/transform">
        <inSequence>
            <!-- PayloadFactory to create a custom payload for each employee -->
            <property name="messageType" scope="axis2" type="STRING" value="application/xml"/>
            <property name="contentType" scope="axis2" type="STRING" value="application/xml"/>
            <foreach expression="//Employees/Employee">
                <sequence>
            
                    <payloadFactory media-type="xml">
                        <format>
                            <EmployeeDetails xmlns="">
                                <EmployeeId>$1</EmployeeId>
                                <EmployeeName>$2</EmployeeName>
                                <EmployeeAge>$3</EmployeeAge>
                                <EmployeeLocation>$4</EmployeeLocation>
                                <EmployeeEmail>$5</EmployeeEmail>
                            </EmployeeDetails>
                        </format>
                        <args>
                            <arg evaluator="xml" expression="//id"/>
                            <arg evaluator="xml" expression="//name"/>
                            <arg evaluator="xml" expression="//age"/>
                            <arg evaluator="xml" expression="//location"/>
                            <arg evaluator="xml" expression="//email"/>
                        </args>
                    </payloadFactory>
                    <!-- You can add further processing logic here, like sending to an endpoint -->
                </sequence>
            </foreach>
   
            <property name="messageType" scope="axis2" type="STRING" value="application/json"/>
            <property name="contentType" scope="axis2" type="STRING" value="application/json"/>
            <respond/>
        </inSequence>
        <outSequence/>
        <faultSequence/>
    </resource>
</api>
